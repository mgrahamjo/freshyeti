{"mobile-geo-photo-demo":{"title":"Mobile geo-tagged photo demo","body":"<p>I am currently considering the merits of native and web applications for an upcoming project. It looks like browser support for access to hardware features like microphone, GPS, and camera is better than I expected, so I've made a quick demo of a feature that records the geographic coordinates at which a photo was uploaded, using the Camera and Geolocation web APIs.</p>\r\n\r\n<p>Please try it out on your mobile device. I will not save any uploaded photos or coordinates, I will only log whether the demo succeeded or failed.</p>\r\n\r\n<div style=\"text-align: center\">\r\n  <h3 id=\"error\" style=\"display:none\">Your browser is not supported.</h3>\r\n  <input type=\"file\" id=\"input\" accept=\"image/*\">\r\n  <p>\r\n  <img style=\"width: 250px\" src=\"/images/default-img.gif\" id=\"photo\">\r\n  </p>\r\n  <div  id=\"location\" style=\"display: none\">\r\n    <p id=\"coords\"></p>\r\n    <div id=\"map-wrap\">\r\n      <iframe id=\"map\"\r\n        width=\"300\"\r\n        height=\"300\"\r\n        frameborder=\"0\" style=\"border:0\">\r\n      </iframe>\r\n      <div id=\"marker\"></div>\r\n    </div>\r\n    <p></p>\r\n    <iframe height=\"200\" allowTransparency=\"true\" frameborder=\"0\" scrolling=\"no\" style=\"width:100%;border:none;margin:10px;\"  src=\"https://mikejcodes.wufoo.com/embed/zahtfnt1n6jdrw/\"></iframe>\r\n  </div>\r\n</div>\r\n\r\n<p>If you're interested in the code and don't feel like opening your dev tools, here's the gist of it:</p>\r\n\r\n<pre class=\"language-html\"><code>&lt;input type=\"file\" id=\"input\" accept=\"image/*\">\r\n&lt;img style=\"width: 250px\" id=\"photo\">\r\n&lt;img id=\"map\" height=\"300\" width=\"300\" />\r\n&lt;script>\r\nvar fileReader = new FileReader(),\r\n  input = document.querySelector('#input'),\r\n  photo = document.querySelector('#photo'),\r\n  map = document.querySelector('#map');\r\ninput.onchange = function(e) {\r\n  if (e.target.files.length > 0) {\r\n    fileReader.onload = function(e) {\r\n      photo.src = e.target.result;\r\n    }\r\n    fileReader.readAsDataURL(e.target.files[0]);\r\n  }\r\n  navigator.geolocation.getCurrentPosition(function(position) {\r\n    var lat = position.coords.latitude,\r\n      lon = position.coords.longitude;\r\n    // use coordinates as you please here...\r\n  });\r\n};\r\n&lt;/script>\r\n</code></pre>\r\n<style type=\"text/css\">\r\n#map {\r\n  position: absolute;\r\n  left: 0;\r\n}\r\n#map-wrap {\r\n  width: 300px;\r\n  height: 300px;\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n#marker {\r\n  width: 10px;\r\n  height: 10px;\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  margin: -5px 0 0 -5px;\r\n  background-color: #ff7a7a;\r\n  border-radius: 10px;\r\n  z-index: 1;\r\n}\r\n</style>\r\n<script>\r\n(function() {\r\n  function fail() {\r\n    document.querySelector('#error').style.display = 'block';\r\n    ga('send', 'event', 'geophoto', 'failure');\r\n  }\r\n  try {\r\n    var fileReader = new FileReader(),\r\n      photoInput = document.querySelector('#input'),\r\n      photo = document.querySelector('#photo'),\r\n      location = document.querySelector('#location'),\r\n      coords = document.querySelector('#coords'),\r\n      map = document.querySelector('#map');\r\n    photoInput.onchange = function(e) {\r\n      if (e.target.files.length > 0) {\r\n        fileReader.onload = function(e) {\r\n          photo.src = e.target.result;\r\n        }\r\n        fileReader.readAsDataURL(e.target.files[0]);\r\n      }\r\n      navigator.geolocation.getCurrentPosition(function(position) {\r\n        var lat = position.coords.latitude,\r\n          lon = position.coords.longitude;\r\n        map.src = 'https://www.google.com/maps/embed/v1/place?key=AIzaSyBGGLsdyH2wHVEqw66klPJSbj1GbxcVvCo&q=test&zoom=13&center=' + lat + ',' + lon;\r\n        coords.innerHTML = 'This photo was uploaded at coordinates: ' + lat + ', ' + lon;\r\n        location.style.display = 'block';\r\n        ga('send', 'event', 'geophoto', 'success');\r\n      }, fail);\r\n    };\r\n  } catch(err) {\r\n    fail();\r\n    console.error(err);\r\n  }\r\n})()</script>","date":"Mon Nov 21 2016","live":"on"}}